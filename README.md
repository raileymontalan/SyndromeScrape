# FASSSTER News System

## File System
| Folder Name | Description |
|:---------|:-------|
| fassster | Contains the front-end of FASSSTER. For the News system, only `syndromic.html` and `news.js` were modified. The extra files (pertaining to Firebase) can be ignored, as they were only used for the purpose of deploying a demo version. |
| models   | Contains the trained models used by the system. |
| modules  | Contains the sets of methods defined for each module. |
| static   | Contains pertinent static files generated by the system. |
| training | Contains the files used to train the models. Can be reused if models must be retrained. |

## Setting up the environment

Create a Python virtual environment (Python 3.x). This can be done either through `conda` (if Python was installed with Anaconda) or `venv`.

Install the necessary packages through the given `requirements.txt` file. In the directory of the file and with the environment activated, run the following on the terminal:

```bash
$ pip install -r requirements.txt
```

Now, identify the API credentials to allow the system to write to Cloud Firestore. In the main directory, run the following on the terminal:

```bash
$ export GOOGLE_APPLICATION_CREDENTIALS="static/api_key.json"
```

## Running the system

To run the system, first turn on the MongoDB server. On bash, the command is as follows:

```bash
$ sudo mongod
```

For Windows or MacOS (Homebrew), check respective documentation for running the MongoDB server.

Afterwards, run the `main.py`:

```bash
$ python main.py
```

The system should be run once daily to scrape sufficient data for visualization.

## API

The structure of the database in Cloud Firestore is as follows:

Collections:

+ incidents
+ statuses
+ trends

Documents:

+ dengue&2012
+ dengue&2014
+ . . .
+ measles&2016
+ typhoid&2008
+ . . .

Each collection contains data for a specific type of information (incidents, statuses, trends). Each document contains all instances in a given year. The structure of a document is as follows:

```json
{
    "type": "FeatureCollection",

    "features": [{
                "type": "Feature",
                "properties": {
                    "date-start": "2015-06-30",
                    "title": "Isabela town in state of calamity due to dengue",
                    "url": "https://www.rappler.com/nation/97920-luna-isabela-state-of-calamity-dengue",
                    "incident": "54"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [120.568897, 15.14962]
                },
                {...}
            }]
}
```


The system queries for an entire year's worth of data once the user clicks the "Visualize" button. The structure of the URL to retrieve data is as follows:

`"https://firestore.googleapis.com/v1beta1/projects/fassster-news/databases/(default)/documents/incidents/" + disease + "&" + year`

where `disease` pertains to the disease selected by the user and `year` the selected year.

An example URL would be

`https://firestore.googleapis.com/v1beta1/projects/fassster-news/databases/(default)/documents/incidents/dengue&2012`

which would return the requested data.

## Contact

For any questions about the system or bugs that cannot be resolved without the original creator's intervention, send an email to either of the following persons:

+ Bea Adajar: beatrice.adajar@obf.ateneo.edu
+ Railey Montalan: jann.montalan@obf.ateneo.edu
